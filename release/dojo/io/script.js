//>>built
define("dojo/io/script",["../_base/connect","../_base/kernel","../_base/lang","../_base/sniff","../_base/window","../_base/xhr","../dom","../dom-construct"],function(g,e,h,i,j,f,k,l){var m=i("ie")?"onreadystatechange":"load",n=/complete|loaded/,d={get:function(a){var c=this._makeScriptDeferred(a),b=c.ioArgs;f._ioAddQueryToUrl(b);f._ioNotifyStart(c);if(this._canAttach(b)){var d=this.attach(b.id,b.url,a.frameDoc);if(!b.jsonp&&!b.args.checkString)var e=g.connect(d,m,function(a){if(a.type=="load"||n.test(d.readyState))g.disconnect(e),
b.scriptLoaded=a})}f._ioWatch(c,this._validCheck,this._ioCheck,this._resHandle);return c},attach:function(a,c,b){var b=b||j.doc,d=b.createElement("script");d.type="text/javascript";d.src=c;d.id=a;d.async=!0;d.charset="utf-8";return b.getElementsByTagName("head")[0].appendChild(d)},remove:function(a,c){l.destroy(k.byId(a,c));this["jsonp_"+a]&&delete this["jsonp_"+a]},_makeScriptDeferred:function(a){var c=f._ioSetArgs(a,this._deferredCancel,this._deferredOk,this._deferredError),b=c.ioArgs;b.id=e._scopeName+
"IoScript"+this._counter++;b.canDelete=!1;b.jsonp=a.callbackParamName||a.jsonp;if(b.jsonp)b.query=b.query||"",b.query.length>0&&(b.query+="&"),b.query+=b.jsonp+"="+(a.frameDoc?"parent.":"")+e._scopeName+".io.script.jsonp_"+b.id+"._jsonpCallback",b.frameDoc=a.frameDoc,b.canDelete=!0,c._jsonpCallback=this._jsonpCallback,this["jsonp_"+b.id]=c;return c},_deferredCancel:function(a){a.canceled=!0;a.ioArgs.canDelete&&d._addDeadScript(a.ioArgs)},_deferredOk:function(a){a=a.ioArgs;a.canDelete&&d._addDeadScript(a);
return a.json||a.scriptLoaded||a},_deferredError:function(a,c){c.ioArgs.canDelete&&(a.dojoType=="timeout"?d.remove(c.ioArgs.id,c.ioArgs.frameDoc):d._addDeadScript(c.ioArgs));return a},_deadScripts:[],_counter:1,_addDeadScript:function(a){d._deadScripts.push({id:a.id,frameDoc:a.frameDoc});a.frameDoc=null},_validCheck:function(){var a=d._deadScripts;if(a&&a.length>0){for(var c=0;c<a.length;c++)d.remove(a[c].id,a[c].frameDoc),a[c].frameDoc=null;d._deadScripts=[]}return!0},_ioCheck:function(a){a=a.ioArgs;
if(a.json||a.scriptLoaded&&!a.args.checkString)return!0;return(a=a.args.checkString)&&eval("typeof("+a+") != 'undefined'")},_resHandle:function(a){d._ioCheck(a)?a.callback(a):a.errback(Error("inconceivable dojo.io.script._resHandle error"))},_canAttach:function(){return!0},_jsonpCallback:function(a){this.ioArgs.json=a}};h.setObject("dojo.io.script",d);return d});